--- ../old/libvorbis-1.2.0.dfsg/lib/codebook.c	2007-07-24 00:09:47.000000000 +0000
+++ libvorbis-1.2.0.dfsg/lib/codebook.c	2008-05-23 08:18:46.000000000 +0000
@@ -158,6 +158,8 @@
   s->dim=oggpack_read(opb,16);
   s->entries=oggpack_read(opb,24);
   if(s->entries==-1)goto _eofout;
+  
+  if(_ilog(s->dim)+_ilog(s->entries)>24)goto _eofout; 
 
   /* codeword ordering.... length ordered or unordered? */
   switch((int)oggpack_read(opb,1)){
@@ -225,7 +227,7 @@
       int quantvals=0;
       switch(s->maptype){
       case 1:
-	quantvals=_book_maptype1_quantvals(s);
+	quantvals=(s->dim==0?0:_book_maptype1_quantvals(s));
 	break;
       case 2:
 	quantvals=s->entries*s->dim;
